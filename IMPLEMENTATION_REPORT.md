# Ú¯Ø²Ø§Ø±Ø´ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù‚Øµ Ù¾Ø±ÙˆÚ˜Ù‡ Routix Platform

**ØªØ§Ø±ÛŒØ®:** 2025-10-14  
**Ù¾Ø±ÙˆÚ˜Ù‡:** Routix Platform - AI-Powered Thumbnail Generator

---

## ğŸ“‹ Ø®Ù„Ø§ØµÙ‡ Ø§Ø¬Ø±Ø§ÛŒÛŒ

ØªÙ…Ø§Ù…ÛŒ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù‚Øµ Ùˆ Ù†ÛŒÙ…Ù‡â€ŒÚ©Ø§Ø±Ù‡ Ø¯Ø± Ù¾Ø±ÙˆÚ˜Ù‡ Routix Platform Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ùˆ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù†Ø¯. Ø§ÛŒÙ† Ú¯Ø²Ø§Ø±Ø´ Ø´Ø§Ù…Ù„ Ø¬Ø²Ø¦ÛŒØ§Øª Ú©Ø§Ù…Ù„ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒØŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ØªØºÛŒÛŒØ± ÛŒØ§ÙØªÙ‡ØŒ Ùˆ Ø¯Ø³ØªÙˆØ±Ø§Ù„Ø¹Ù…Ù„â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø³Øª.

---

## ğŸ¯ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡

### 1. âœ… Template Database System
**ÙˆØ¶Ø¹ÛŒØª:** âœ”ï¸ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡

#### Ø´Ø±Ø­:
Ø³ÛŒØ³ØªÙ… Ú©Ø§Ù…Ù„ Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ùˆ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ (templates) thumbnail Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯.

#### ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯:
- `routix-backend/src/models/template.py` - Ù…Ø¯Ù„ Template Ø¨Ø§ 10 Ø§Ù„Ú¯ÙˆÛŒ Ø§Ø² Ù¾ÛŒØ´ ØªØ¹Ø±ÛŒÙ Ø´Ø¯Ù‡
- `routix-backend/src/schemas/template.py` - Schema Ù‡Ø§ÛŒ Pydantic Ø¨Ø±Ø§ÛŒ validation

#### ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ØªØºÛŒÛŒØ± ÛŒØ§ÙØªÙ‡:
- `routix-backend/src/models/__init__.py` - Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù† Template Ø¨Ù‡ exports
- `routix-backend/src/core/seed_data.py` - Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù† ØªØ§Ø¨Ø¹ `seed_templates()`

#### ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§:
- âœ¨ 10 Ø§Ù„Ú¯ÙˆÛŒ Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø¯Ø± 6 Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ (Gaming, Tech, Education, Business, Lifestyle, Entertainment)
- ğŸ¨ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² color schemes, styles, moods
- ğŸ“Š Ø³ÛŒØ³ØªÙ… Ø§Ù…ØªÛŒØ§Ø²Ø¯Ù‡ÛŒ Ùˆ tracking Ø§Ø³ØªÙØ§Ø¯Ù‡
- ğŸ” Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… Ù‡ÙˆØ´Ù…Ù†Ø¯ match scoring Ø¨Ø§ ÙˆØ²Ù†â€ŒÙ‡Ø§ÛŒ Ù‚Ø§Ø¨Ù„ ØªÙ†Ø¸ÛŒÙ…
- ğŸ·ï¸ Ø³ÛŒØ³ØªÙ… ØªÚ¯â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ùˆ categorization Ù¾ÛŒØ´Ø±ÙØªÙ‡

#### Ù…Ø«Ø§Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡:
```python
from src.models.template import Template

# Calculate match score
template = Template.query.first()
analysis = {
    "category": "gaming",
    "style": "bold",
    "mood": "exciting",
    "elements": ["text", "background", "effects"]
}
score = template.calculate_match_score(analysis)
```

---

### 2. âœ… Template Matching Logic
**ÙˆØ¶Ø¹ÛŒØª:** âœ”ï¸ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡

#### Ø´Ø±Ø­:
Ù…Ù†Ø·Ù‚ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¨Ø±Ø§ÛŒ ÛŒØ§ÙØªÙ† Ùˆ ØªØ·Ø¨ÛŒÙ‚ Ø¨Ù‡ØªØ±ÛŒÙ† Ø§Ù„Ú¯ÙˆÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ ØªØ­Ù„ÛŒÙ„ prompt Ú©Ø§Ø±Ø¨Ø±.

#### ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ØªØºÛŒÛŒØ± ÛŒØ§ÙØªÙ‡:
- `routix-backend/src/services/ai_service.py` - ØªØ§Ø¨Ø¹ `find_matching_templates()` Ú©Ø§Ù…Ù„ Ø´Ø¯
- `routix-backend/src/services/generation_service.py` - ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ template database

#### ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§:
- ğŸ¤– ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ AI analysis
- ğŸ¯ Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… scoring Ú†Ù†Ø¯ Ù„Ø§ÛŒÙ‡ (category, style, mood, elements)
- ğŸ“ˆ Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ match score, rating, Ùˆ usage count
- ğŸ”„ Fallback mechanism Ø¨Ø±Ø§ÛŒ Ø²Ù…Ø§Ù† Ø®Ø§Ù„ÛŒ Ø¨ÙˆØ¯Ù† Ø¯ÛŒØªØ§Ø¨ÛŒØ³
- âš¡ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² min_score Ùˆ limit Ø¨Ø±Ø§ÛŒ filtering

#### Ù…Ø«Ø§Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡:
```python
templates = await ai_service.find_matching_templates(
    analysis=analysis,
    db_session=db,
    limit=5,
    min_score=0.5
)
# Returns top 5 templates with score >= 0.5
```

---

### 3. âœ… AI Chat Processing
**ÙˆØ¶Ø¹ÛŒØª:** âœ”ï¸ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡

#### Ø´Ø±Ø­:
Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ú†Øª Ø¨Ø§ ØªØ´Ø®ÛŒØµ Ù†ÛŒØª Ú©Ø§Ø±Ø¨Ø± Ùˆ ØªÙˆÙ„ÛŒØ¯ Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§ÛŒ Ù…Ù†Ø§Ø³Ø¨.

#### ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ØªØºÛŒÛŒØ± ÛŒØ§ÙØªÙ‡:
- `routix-backend/src/api/v1/endpoints/chat.py` - Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„ AI processing

#### ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§:
- ğŸ§  ØªØ´Ø®ÛŒØµ Ù†ÛŒØª Ú©Ø§Ø±Ø¨Ø± (Intent Detection) Ø¨Ø§ AI
- ğŸ’¬ ØªÙˆÙ„ÛŒØ¯ Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ùˆ contextual
- ğŸ” Ø¯Ùˆ Ù„Ø§ÛŒÙ‡ detection: keyword-based + AI-powered
- ğŸ“ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ assistant
- âš¡ Fallback mechanism Ø¨Ø±Ø§ÛŒ Ø¹Ø¯Ù… Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ AI

#### ØªÙˆØ§Ø¨Ø¹ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡:
```python
async def _analyze_chat_intent(message: str, ai_service: AIService) -> bool
async def _generate_assistant_response(user_message: str, requires_generation: bool, ai_service: AIService) -> str
```

#### Ù…Ø«Ø§Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡:
Ú©Ø§Ø±Ø¨Ø±: "I want to create a gaming thumbnail"  
â†’ System: ØªØ´Ø®ÛŒØµ Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªÙˆÙ„ÛŒØ¯  
â†’ Assistant: "I'd be happy to help you create a thumbnail! Could you provide more details about what you have in mind?"

---

### 4. âœ… Cancel Generation (Backend + Frontend)
**ÙˆØ¶Ø¹ÛŒØª:** âœ”ï¸ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡

#### Ø´Ø±Ø­:
Ù‚Ø§Ø¨Ù„ÛŒØª Ù„ØºÙˆ ØªÙˆÙ„ÛŒØ¯ thumbnail Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù….

#### Ù†Ú©ØªÙ‡ Ù…Ù‡Ù…:
API endpoint Ø§Ø² Ù‚Ø¨Ù„ Ù…ÙˆØ¬ÙˆØ¯ Ø¨ÙˆØ¯ (`DELETE /generations/generations/{id}`). ÙÙ‚Ø· Ø§ØªØµØ§Ù„ ÙØ±Ø§Ù†Øªâ€ŒØ§Ù†Ø¯ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯.

#### ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ØªØºÛŒÛŒØ± ÛŒØ§ÙØªÙ‡:
- `routix-frontend/src/components/chat/generation-progress.tsx` - Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù† handler Ø¨Ø±Ø§ÛŒ cancel
- `routix-frontend/src/lib/api.ts` - ØªØ§Ø¨Ø¹ `cancelGeneration()` Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯

#### ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§:
- â¸ï¸ Ù„ØºÙˆ Ø³Ø±ÛŒØ¹ ØªÙˆÙ„ÛŒØ¯Ù‡Ø§ÛŒ Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù… ÛŒØ§ Ø¯Ø± ØµÙ
- ğŸ”„ Invalidation Ø®ÙˆØ¯Ú©Ø§Ø± cache
- â³ Ù†Ù…Ø§ÛŒØ´ loading state Ù‡Ù†Ú¯Ø§Ù… Ù„ØºÙˆ
- ğŸš« Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù„ØºÙˆ ØªÙˆÙ„ÛŒØ¯Ù‡Ø§ÛŒ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡
- â™¿ Disabled state Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ú©Ù„ÛŒÚ©â€ŒÙ‡Ø§ÛŒ Ù…Ú©Ø±Ø±

#### Ù…Ø«Ø§Ù„ Ú©Ø¯:
```tsx
const handleCancel = async () => {
  await generationAPI.cancelGeneration(generation.id)
  queryClient.invalidateQueries({ queryKey: ['generations'] })
}
```

---

### 5. âœ… Payment Integration System
**ÙˆØ¶Ø¹ÛŒØª:** âœ”ï¸ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡

#### Ø´Ø±Ø­:
Ø³ÛŒØ³ØªÙ… Ú©Ø§Ù…Ù„ Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ Ø§Ø¹ØªØ¨Ø§Ø± (credits) Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² webhook Ù‡Ø§.

#### ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯:
- `routix-backend/src/services/payment_service.py` - Ø³Ø±ÙˆÛŒØ³ Ú©Ø§Ù…Ù„ Ù¾Ø±Ø¯Ø§Ø®Øª
- `routix-frontend/src/lib/api.ts` - API client Ú©Ø§Ù…Ù„
- `routix-frontend/src/lib/utils.ts` - ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ

#### ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ØªØºÛŒÛŒØ± ÛŒØ§ÙØªÙ‡:
- `routix-backend/src/api/v1/endpoints/users.py` - 4 endpoint Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø®Øª
- `routix-frontend/src/app/chat/credits/page.tsx` - Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„ purchase flow

#### Endpoints Ø¬Ø¯ÛŒØ¯ (Backend):
```python
POST /users/credits/purchase/intent    # Ø§ÛŒØ¬Ø§Ø¯ payment intent
POST /users/credits/purchase            # Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù¾Ø±Ø¯Ø§Ø®Øª
GET  /users/credits/packages            # Ù„ÛŒØ³Øª Ø¨Ø³ØªÙ‡â€ŒÙ‡Ø§ÛŒ Ø§Ø¹ØªØ¨Ø§Ø±
POST /users/credits/webhook             # Webhook handler
```

#### Ø¨Ø³ØªÙ‡â€ŒÙ‡Ø§ÛŒ Ø§Ø¹ØªØ¨Ø§Ø±:
1. **Starter Pack**: 50 credits ($9.99)
2. **Popular Pack**: 150 + 25 bonus credits ($24.99) â­
3. **Pro Pack**: 300 + 75 bonus credits ($49.99)

#### ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§:
- ğŸ’³ Ù…Ø¹Ù…Ø§Ø±ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Stripe, PayPal, Square
- ğŸ” Webhook handling Ø¨Ø±Ø§ÛŒ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø®Øª
- ğŸ’° Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² bonus credits
- ğŸ“Š Transaction tracking Ú©Ø§Ù…Ù„
- ğŸ”„ Refund handling
- ğŸ¯ Mock implementation Ø¨Ø±Ø§ÛŒ development

#### Ù†Ø­ÙˆÙ‡ ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Stripe (Ù…Ø«Ø§Ù„):
```python
# Ø¯Ø± production Ø¨Ù‡ Ø¬Ø§ÛŒ mock implementation:
import stripe
stripe.api_key = settings.stripe_api_key

intent = stripe.PaymentIntent.create(
    amount=int(package["price"] * 100),
    currency="usd",
    customer=user.stripe_customer_id,
    metadata={"user_id": user.id, "package_id": package_id}
)
```

---

### 6. âœ… Frontend API Client
**ÙˆØ¶Ø¹ÛŒØª:** âœ”ï¸ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡

#### Ø´Ø±Ø­:
Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ú©Ø§Ù…Ù„ API client Ø¨Ø±Ø§ÛŒ ØªÙ…Ø§Ù… endpoints Ø¨Ø§ Ù…Ø¯ÛŒØ±ÛŒØª Ø®ÙˆØ¯Ú©Ø§Ø± authentication.

#### ÙØ§ÛŒÙ„ Ø¬Ø¯ÛŒØ¯:
- `routix-frontend/src/lib/api.ts` (149 Ø®Ø·)
- `routix-frontend/src/lib/utils.ts` (56 Ø®Ø·)

#### ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§:
- ğŸ” Ù…Ø¯ÛŒØ±ÛŒØª Ø®ÙˆØ¯Ú©Ø§Ø± JWT tokens
- ğŸ”„ Auto-refresh token
- ğŸ“¡ Interceptors Ø¨Ø±Ø§ÛŒ request/response
- ğŸš¨ Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§ÛŒ 401 (Auto-redirect)
- ğŸ“¦ Axios instance Ø¨Ø§ config Ù¾ÛŒØ´â€ŒÙØ±Ø¶

#### API Modules:
- `authAPI` - Authentication endpoints
- `userAPI` - User management & credits
- `generationAPI` - Thumbnail generation
- `chatAPI` - Conversations & messages
- `fileAPI` - File upload/management

---

## ğŸ“ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯/ØªØºÛŒÛŒØ± ÛŒØ§ÙØªÙ‡

### ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ (9 ÙØ§ÛŒÙ„):

#### Backend (3 ÙØ§ÛŒÙ„):
1. `routix-backend/src/models/template.py` (310 Ø®Ø·)
2. `routix-backend/src/schemas/template.py` (79 Ø®Ø·)
3. `routix-backend/src/services/payment_service.py` (334 Ø®Ø·)

#### Frontend (3 ÙØ§ÛŒÙ„):
4. `routix-frontend/src/lib/api.ts` (149 Ø®Ø·)
5. `routix-frontend/src/lib/utils.ts` (56 Ø®Ø·)

**Ù…Ø¬Ù…ÙˆØ¹ Ø®Ø·ÙˆØ· Ú©Ø¯ Ø¬Ø¯ÛŒØ¯:** ~928 Ø®Ø·

### ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ØªØºÛŒÛŒØ± ÛŒØ§ÙØªÙ‡ (9 ÙØ§ÛŒÙ„):

#### Backend (5 ÙØ§ÛŒÙ„):
1. `routix-backend/src/models/__init__.py`
2. `routix-backend/src/core/seed_data.py`
3. `routix-backend/src/services/ai_service.py`
4. `routix-backend/src/services/generation_service.py`
5. `routix-backend/src/api/v1/endpoints/users.py`
6. `routix-backend/src/api/v1/endpoints/chat.py`

#### Frontend (3 ÙØ§ÛŒÙ„):
7. `routix-frontend/src/components/chat/generation-progress.tsx`
8. `routix-frontend/src/app/chat/credits/page.tsx`

---

## ğŸš€ Ø¯Ø³ØªÙˆØ±Ø§Ù„Ø¹Ù…Ù„ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ

### 1. Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Backend

```bash
cd routix-backend

# Ù†ØµØ¨ dependencies (Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø²)
pip install -r requirements.txt

# Ø§Ø¬Ø±Ø§ÛŒ migrations Ø¨Ø±Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ø¯ÙˆÙ„ template
# (Ø¯Ø± ØµÙˆØ±Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Alembic)
alembic revision --autogenerate -m "Add template model"
alembic upgrade head

# ÛŒØ§ Ø¨Ù‡ ØµÙˆØ±Øª Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ø§ seed data
PYTHONPATH=$(pwd) python3 -c "
import asyncio
from src.core.database import AsyncSessionLocal
from src.core.seed_data import seed_database

async def main():
    async with AsyncSessionLocal() as db:
        await seed_database(db)

asyncio.run(main())
"

# Ø§Ø¬Ø±Ø§ÛŒ Ø³Ø±ÙˆØ±
PYTHONPATH=$(pwd) uvicorn src.main:app --reload --host 0.0.0.0 --port 8000
```

### 2. Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Frontend

```bash
cd routix-frontend

# Ù†ØµØ¨ dependencies
npm install

# Ø§Ø¬Ø±Ø§ÛŒ development server
npm run dev
```

### 3. ØªØ³Øª Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§

#### ØªØ³Øª Template System:
```bash
# Ø¨Ø±Ø±Ø³ÛŒ seed data
curl http://localhost:8000/api/v1/templates

# ØªØ³Øª template matching
curl -X POST http://localhost:8000/api/v1/generations/match-templates \
  -H "Content-Type: application/json" \
  -d '{"prompt": "Create a gaming thumbnail", "limit": 5}'
```

#### ØªØ³Øª Chat Processing:
```bash
# Ø§ÛŒØ¬Ø§Ø¯ conversation
CONV_ID=$(curl -X POST http://localhost:8000/api/v1/chat/conversations \
  -H "Authorization: Bearer $TOKEN" \
  -d '{"title": "Test"}' | jq -r '.id')

# Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù…
curl -X POST http://localhost:8000/api/v1/chat/conversations/$CONV_ID/chat \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"message": "I want to create a gaming thumbnail"}'
```

#### ØªØ³Øª Payment System:
```bash
# Ø¯Ø±ÛŒØ§ÙØª Ù„ÛŒØ³Øª Ø¨Ø³ØªÙ‡â€ŒÙ‡Ø§
curl http://localhost:8000/api/v1/users/credits/packages

# Ø§ÛŒØ¬Ø§Ø¯ payment intent
curl -X POST http://localhost:8000/api/v1/users/credits/purchase/intent \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"package_id": "popular"}'

# Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù¾Ø±Ø¯Ø§Ø®Øª (mock)
curl -X POST http://localhost:8000/api/v1/users/credits/purchase \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"package_id": "popular", "payment_method_id": "pm_mock_123"}'
```

#### ØªØ³Øª Cancel Generation:
Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø±:
1. ÙˆØ§Ø±Ø¯ ØµÙØ­Ù‡ chat Ø´ÙˆÛŒØ¯
2. ÛŒÚ© generation Ø§ÛŒØ¬Ø§Ø¯ Ú©Ù†ÛŒØ¯
3. Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ X (Cancel) Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯
4. Generation Ø¨Ø§ÛŒØ¯ Ù„ØºÙˆ Ø´ÙˆØ¯ Ùˆ status Ø¨Ù‡ "cancelled" ØªØºÛŒÛŒØ± Ú©Ù†Ø¯

---

## ğŸ” Ø¬Ø²Ø¦ÛŒØ§Øª ÙÙ†ÛŒ

### Ù…Ø¹Ù…Ø§Ø±ÛŒ Template Matching

```
User Prompt
    â†“
AI Analysis (GPT-4/Gemini)
    â†“
{category, style, mood, elements}
    â†“
Template Database Query
    â†“
Score Calculation (weighted):
  - Category match: 40%
  - Style match: 30%
  - Mood match: 20%
  - Element overlap: 10%
    â†“
Sort by (score, rating, usage)
    â†“
Return Top N Templates
```

### Ù…Ø¹Ù…Ø§Ø±ÛŒ Payment Flow

```
Frontend Request
    â†“
Create Payment Intent
    â†“
[Payment Gateway] (Stripe/PayPal)
    â†“
Process Payment
    â†“
Webhook Event
    â†“
Add Credits to User
    â†“
Create Transaction Record
    â†“
Return Success Response
```

### AI Chat Processing Flow

```
User Message
    â†“
Intent Analysis:
  1. Keyword Detection
  2. AI Classification (GPT-3.5)
    â†“
requires_generation: bool
    â†“
Generate Response:
  - If generation needed: Clarifying questions
  - If general chat: Helpful information
    â†“
Save Messages to DB
    â†“
Return to Frontend
```

---

## ğŸ“Š Ø¢Ù…Ø§Ø± Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ

- âœ… **Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡:** 6
- ğŸ“ **ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯:** 5
- ğŸ”§ **ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ØªØºÛŒÛŒØ± ÛŒØ§ÙØªÙ‡:** 9
- ğŸ“ **Ø®Ø·ÙˆØ· Ú©Ø¯ Ø¬Ø¯ÛŒØ¯:** ~928
- ğŸ¯ **Coverage:** 100% Ø§Ø² TODOÙ‡Ø§
- â±ï¸ **Ø²Ù…Ø§Ù† Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ:** Ù…Ø·Ø§Ø¨Ù‚ Ø¨Ø§ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯Ù‡Ø§ÛŒ production

---

## ğŸ“ Ù†Ú©Ø§Øª Ù…Ù‡Ù… Ø¨Ø±Ø§ÛŒ Production

### 1. Payment Integration
```python
# âš ï¸ Ù‚Ø¨Ù„ Ø§Ø² production:
# 1. Ø«Ø¨Øª Ù†Ø§Ù… Ø¯Ø± Stripe/PayPal
# 2. Ø¯Ø±ÛŒØ§ÙØª API keys
# 3. Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†ÛŒ mock implementation Ø¨Ø§ real API calls
# 4. Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ webhook URL
# 5. ØªØ³Øª Ú©Ø§Ù…Ù„ payment flow
```

### 2. AI Services
```python
# âš ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²:
OPENAI_API_KEY=sk-...
GEMINI_API_KEY=...
MIDJOURNEY_API_KEY=...

# Ø¯Ø± ØµÙˆØ±Øª Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ØŒ fallback mechanisms ÙØ¹Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
```

### 3. Database
```bash
# âš ï¸ Migration Ø¨Ø±Ø§ÛŒ Template model:
alembic revision --autogenerate -m "Add template model"
alembic upgrade head

# Seed initial templates:
python -m src.core.seed_data
```

### 4. Security
```python
# âš ï¸ Ø¯Ø± production:
# 1. ØªØºÛŒÛŒØ± SECRET_KEY Ø¯Ø± .env
# 2. ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ HTTPS
# 3. Verification Ø§Ù…Ø¶Ø§ÛŒ webhook
# 4. Rate limiting Ø±ÙˆÛŒ endpoints Ù¾Ø±Ø¯Ø§Ø®Øª
# 5. Input validation Ùˆ sanitization
```

---

## ğŸ› Ø±ÙØ¹ Ù…Ø´Ú©Ù„Ø§Øª Ø±Ø§ÛŒØ¬

### Ù…Ø´Ú©Ù„ 1: Template Not Found
**Ø¹Ù„Øª:** Ø¯ÛŒØªØ§Ø¨ÛŒØ³ seed Ù†Ø´Ø¯Ù‡  
**Ø±Ø§Ù‡â€ŒØ­Ù„:**
```bash
python -c "from src.core.seed_data import seed_database; ..."
```

### Ù…Ø´Ú©Ù„ 2: Payment Failed
**Ø¹Ù„Øª:** Mock implementation Ø¯Ø± development  
**Ø±Ø§Ù‡â€ŒØ­Ù„:** Ø§ÛŒÙ† Ø±ÙØªØ§Ø± Ø·Ø¨ÛŒØ¹ÛŒ Ø§Ø³Øª. Ø¯Ø± production Ø¨Ø§ real API Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ø´ÙˆØ¯.

### Ù…Ø´Ú©Ù„ 3: AI Response Empty
**Ø¹Ù„Øª:** API keys ØªÙ†Ø¸ÛŒÙ… Ù†Ø´Ø¯Ù‡  
**Ø±Ø§Ù‡â€ŒØ­Ù„:** Fallback Ø¨Ù‡ keyword-based detection Ù…ÛŒâ€ŒØ§ÙØªØ¯.

---

## ğŸ“ˆ Ø¨Ù‡Ø¨ÙˆØ¯Ù‡Ø§ÛŒ Ø¢ØªÛŒ (Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ)

1. **Template Management UI**: Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª templates
2. **Advanced Template Analytics**: Ø¢Ù†Ø§Ù„ÛŒØªÛŒÚ©Ø³ Ú©Ø§Ù…Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² templates
3. **Real Payment Gateway**: ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„ Ø¨Ø§ Stripe
4. **Webhook Retry Logic**: retry Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ø±Ø§ÛŒ webhook failures
5. **Credit Expiration**: Ø³ÛŒØ³ØªÙ… Ø§Ù†Ù‚Ø¶Ø§ÛŒ Ø§Ø¹ØªØ¨Ø§Ø±
6. **Subscription Plans**: Ù¾Ù„Ù†â€ŒÙ‡Ø§ÛŒ Ø§Ø´ØªØ±Ø§Ú© Ù…Ø§Ù‡Ø§Ù†Ù‡
7. **Template Rating System**: Ø§Ù…ØªÛŒØ§Ø²Ø¯Ù‡ÛŒ ØªÙˆØ³Ø· Ú©Ø§Ø±Ø¨Ø±Ø§Ù†
8. **A/B Testing**: ØªØ³Øª templates Ù…Ø®ØªÙ„Ù

---

## âœ… ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡

- âœ… Compilation ØªÙ…Ø§Ù… ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Python
- âœ… Syntax validation
- âœ… Import checks
- âœ… Type consistency
- âœ… API endpoint structure
- âœ… Database model relationships

---

## ğŸ“ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ

Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒÛŒ Ø¨ÛŒØ´ØªØ± ÛŒØ§ ÙˆØ¬ÙˆØ¯ Ù…Ø´Ú©Ù„:
1. Ø¨Ø±Ø±Ø³ÛŒ logs Ø³Ø±ÙˆØ± (`routix-backend`)
2. Ø¨Ø±Ø±Ø³ÛŒ browser console (`routix-frontend`)
3. Ù…Ø±Ø§Ø¬Ø¹Ù‡ Ø¨Ù‡ Ù…Ø³ØªÙ†Ø¯Ø§Øª API: `http://localhost:8000/docs`

---

## ğŸ‰ Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ

ØªÙ…Ø§Ù…ÛŒ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù‚Øµ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù†Ø¯:
- âœ… Template Database & Matching Logic
- âœ… AI Chat Processing
- âœ… Cancel Generation
- âœ… Payment Integration System
- âœ… Frontend API Client

Ù¾Ø±ÙˆÚ˜Ù‡ Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ùˆ ØªØ³Øª Ø§Ø³Øª. Ø¯Ø± ØµÙˆØ±Øª Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø¯Ø± productionØŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ù…Ù†ÛŒØªÛŒ Ùˆ ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ real payment gateway Ø±Ø§ ÙØ±Ø§Ù…ÙˆØ´ Ù†Ú©Ù†ÛŒØ¯.

---

**ØªÙ‡ÛŒÙ‡â€ŒÚ©Ù†Ù†Ø¯Ù‡:** AI Development Agent  
**ØªØ§Ø±ÛŒØ®:** 2025-10-14  
**Ù†Ø³Ø®Ù‡:** 1.0
